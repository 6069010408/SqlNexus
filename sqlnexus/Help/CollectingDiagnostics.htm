<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="CollectingDiagnostics_files/filelist.xml">
<title>Collecting Diagnostics</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:PMingLiU;
	panose-1:2 2 3 0 0 0 0 0 0 0;
	mso-font-alt:\65B0\7D30\660E\9AD4;
	mso-font-charset:136;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:3 137232384 22 0 1048577 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"\@PMingLiU";
	panose-1:2 2 3 0 0 0 0 0 0 0;
	mso-font-charset:136;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:3 137232384 22 0 1048577 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:PMingLiU;
	mso-bidi-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:"Trebuchet MS";
	mso-bidi-font-family:Arial;
	mso-font-kerning:16.0pt;}
h2
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:"Trebuchet MS";
	mso-bidi-font-family:Arial;
	font-style:italic;}
h3
	{mso-style-next:Normal;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	mso-bidi-font-size:13.0pt;
	font-family:"Trebuchet MS";
	mso-bidi-font-family:Arial;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1>Collecting Diagnostics</h1>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>SQL Nexus uses SQL Server’s <span class=SpellE>SQLDiag</span>
facility to collect diagnostics data for SQL Server itself.&nbsp; This means
that not only is the diagnostics data being collected <i>about</i> SQL Server;
it is also being stored <i>by</i> SQL Server in a SQL database.&nbsp; Naturally,
this means that the diagnostics collection should be as unobtrusive and
low-impact as possible.&nbsp; Fortunately, <span class=SpellE>SQLDiag</span>
was designed for minimal system impact and maximum performance.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>When you start SQL Nexus, you are asked whether you would
like to start the diagnostics collector for real-time analysis.&nbsp; This
allows you to run reports over diagnostic data as it is being collected.&nbsp;
You can then view charts and reports that use this event data as it occurs.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>SQL Nexus instructs <span class=SpellE>SQLDiag</span> to run
as a service in order to minimize impact to the system and provide for data
collection that is as robust as possible.&nbsp; The service <span class=SpellE>SQLDiag</span>
will be registered under is named “<span class=SpellE>diag$sqlnexus</span>.”&nbsp;
You can control this service using the Service toolbar in SQL Nexus or using <span
class=SpellE>SQLDiag</span> itself.&nbsp; For additional information about controlling
the <span class=SpellE>SQLDiag</span> collection service using sqldiag.exe, see
the <a href="http://msdn2.microsoft.com/en-us/library/ms162833.aspx"><span
class=SpellE>SQLdiag</span> Utility</a> topic in SQL Server 2005 Books Online. </p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>The diagnostics <span class=SpellE>SQLDiag</span> collects
are determined by an XML configuration file that is passed to it when it is
registered.&nbsp; You can find this file in the “Collection” subfolder under
the SQL Nexus startup folder.&nbsp; Although we do not recommend it, it is
possible to customize the diagnostics configured in this file.&nbsp; Note that
doing so may render some SQL Nexus reports unusable. </p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

<p class=MsoNormal>Some diagnostics necessarily must be collected first to your
local hard drive, <span class=GramE>then</span> loaded into SQL Server rather
than being sent to SQL Server directly.&nbsp; A good example of this is a
Profiler trace.&nbsp; <span class=SpellE>SQLDiag</span> collects server-side
Profiler traces using the <span class=SpellE>sp_trace</span>* family of
extended stored procedures.&nbsp; This means that SQL Server itself writes the
TRC files that are later imported by the SQL Nexus data loader and requires
that you have sufficient disk space available on the machine on which SQL
Server is running in order to store these TRC files, at least
temporarily.&nbsp; The SQL Nexus data loader will load these TRC files into the
Diagnostic Data Warehouse on a regular time interval and will delete files it
has processed, but there must be sufficient disk space to store them until that
occurs.&nbsp; The exact amount of disk space and the length of time it will
need to be available will vary widely between systems based on the activity on
the server and the rate at which it can be processed by the SQL Nexus data
loader.</p>

<p class=MsoNormal><o:p>&nbsp;</o:p></p>

</div>

</body>

</html>
