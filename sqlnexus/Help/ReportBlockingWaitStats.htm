<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="ReportBlockingWaitStats_files/filelist.xml">
<title>Report Description: Profiler Trace Analysis</title>
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:SpellingState>Clean</w:SpellingState>
  <w:GrammarState>Clean</w:GrammarState>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 2 3 0 0 0 0 0 0 0;
	mso-font-alt:\65B0\7D30\660E\9AD4;
	mso-font-charset:136;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:3 137232384 22 0 1048577 0;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"\@PMingLiU";
	panose-1:2 2 3 0 0 0 0 0 0 0;
	mso-font-charset:136;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:3 137232384 22 0 1048577 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Trebuchet MS";
	mso-fareast-font-family:PMingLiU;
	mso-bidi-font-family:"Times New Roman";}
h1
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:16.0pt;
	font-family:"Trebuchet MS";}
h2
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:14.0pt;
	font-family:"Trebuchet MS";
	font-style:italic;}
h3
	{margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	font-family:"Trebuchet MS";}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
span.SpellE
	{mso-style-name:"";
	mso-spl-e:yes;}
span.GramE
	{mso-style-name:"";
	mso-gram-e:yes;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:830221928;
	mso-list-type:hybrid;
	mso-list-template-ids:-199458806 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1
	{mso-list-id:2097479852;
	mso-list-template-ids:-85838840;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Table Normal";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0in 5.4pt 0in 5.4pt;
	mso-para-margin:0in;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]-->
</head>

<body lang=EN-US link=blue vlink=purple style='tab-interval:.5in'>

<div class=Section1>

<h1><span lang=EN-ZW style='mso-ansi-language:EN-ZW'>Report Description: Blocking
and Wait Statistics</span></h1>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'>The purpose
of the Blocking and Wait Statistics top-level report is to provide a view of lock
blocking and other resource wait bottlenecks. <span
style='mso-spacerun:yes'> </span>You would typically use this report when
server performance is impaired, but the server is not CPU-bound. <span
style='mso-spacerun:yes'> </span>Start with the Profiler Trace Analysis report if
you have a performance problem characterized by sustained high CPU use (most high
CPU problems stem from a particular expensive query). <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'>By default,
the report reflects the most recent 4 hour period. <span
style='mso-spacerun:yes'> </span>You can narrow or expand the time window by
clicking the Parameters button on the report toolbar. <span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'>The
Blocking and Wait Statistics report requires a SQL Server 2005 instance, as it is
based on data collected from dynamic management views that do not exist on
prior versions.<span style='mso-spacerun:yes'>  </span>It is recommended that
you use live data collection </span>to<span style='mso-ansi-language:EN-ZW'> <span
lang=EN-ZW>gather the data on which this report is based (answer </span></span><span
class=GramE><i style='mso-bidi-font-style:normal'>Yes</i></span> when SQL Nexus
asks whether you want to start the data collector)<span lang=EN-ZW
style='mso-ansi-language:EN-ZW'>. <span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'>The first
chart on the report reflects the top 5 wait categories that contributed to
resource waits on the system.<span style='mso-spacerun:yes'>  </span>(A “wait
category” is either a SQL Server wait type or a family of related wait types. <span
style='mso-spacerun:yes'> </span>For example, all lock wait types are grouped together
into a single wait category.<span style='mso-spacerun:yes'>  </span>For a
description of SQL Server 2005 wait types, see the <a
href="http://msdn2.microsoft.com/en-us/library/ms179984.asp">sys.dm_os_wait_stats</a>
Books Online topic.)<span style='mso-spacerun:yes'>  </span>If you are
experiencing a major lock blocking problem, high lock waits should show up in
this chart. <span style='mso-spacerun:yes'> </span>You may also see other wait
categories here.<span style='mso-spacerun:yes'>  </span>Some examples: <o:p></o:p></span></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l0 level1 lfo2;tab-stops:list .5in'><span
     lang=EN-ZW style='mso-ansi-language:EN-ZW'>Locks – This indicates that lock
     blocking is occurring on the system. <span
     style='mso-spacerun:yes'> </span>See the information later in this help
     topic describing the Blocking Chains section of the report. <o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo2;tab-stops:list .5in'><span
     lang=EN-ZW style='mso-ansi-language:EN-ZW'>Page I/O Latch, I/O Completion,
     and <span class=SpellE>Writelog</span> – These wait categories indicate
     that SQL Server is waiting on the disk subsystem. <o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo2;tab-stops:list .5in'><span
     lang=EN-ZW style='mso-ansi-language:EN-ZW'>Page Latch (non-I/O) – The most
     common cause of high waits in this wait category is discussed in KB <a
     href="http://support.microsoft.com/kb/328551">328551</a>. <o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo2;tab-stops:list .5in'><span
     lang=EN-ZW style='mso-ansi-language:EN-ZW'>Latch (non-buffer) – If this
     wait category dominates, run a SELECT * FROM sys.dm_exec_requests. <span
     style='mso-spacerun:yes'> </span>Look at the <span class=SpellE>wait_resource</span>
     column of the requests that have a LATCH* <span class=SpellE>wait_type</span>
     to determine the type of latch that they are waiting for. <o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo2;tab-stops:list .5in'><span
     lang=EN-ZW style='mso-ansi-language:EN-ZW'>Network I/O (client fetch) –
     This wait type indicates that SQL Server is waiting for the client
     application to fetch rows. <o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo2;tab-stops:list .5in'><span
     lang=EN-ZW style='mso-ansi-language:EN-ZW'>Compilation – This wait category
     is used when a thread must wait to allocate or release memory from a
     thread-safe memory object. <span style='mso-spacerun:yes'> </span>It can
     occur for a variety of reasons, but the most frequent cause of bottlenecks
     characterized by this wait type is a workload that makes poor use of the
     procedure cache and inserts/removes plans from cache at a very high rate. <span
     style='mso-spacerun:yes'> </span>Applications that explicitly parameterize
     queries are much less likely to hit this problem.<span
     style='mso-spacerun:yes'>  </span>SQL Server 2005 Service Pack 2 includes
     some architectural changes that may help. <span
     style='mso-spacerun:yes'> </span>In some cases SQL Server 2005’s FORCED
     PARAMETERIZATION feature can provide short-term relief.<span
     style='mso-spacerun:yes'>  </span><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo2;tab-stops:list .5in'><span
     class=SpellE><span lang=EN-ZW style='mso-ansi-language:EN-ZW'>XProc</span></span><span
     lang=EN-ZW style='mso-ansi-language:EN-ZW'> – Indicates that worker
     threads are waiting for an extended stored procedure to finish execution. <span
     style='mso-spacerun:yes'> </span><o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo2;tab-stops:list .5in'><span
     lang=EN-ZW style='mso-ansi-language:EN-ZW'>OLEDB – This wait type may be a
     sign that SQL Server is waiting for linked server queries against remote
     data sources. <span style='mso-spacerun:yes'> </span>The same wait type is
     also used for Full Text Search queries and certain DBCC commands. <o:p></o:p></span></li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo2;tab-stops:list .5in'><span
     lang=EN-ZW style='mso-ansi-language:EN-ZW'>Memory – Most frequently, this
     wait category indicates that one or more queries are poorly tuned and are
     consuming large amounts of visible buffer pool memory. <span
     style='mso-spacerun:yes'> </span>Use the Profiler Trace Analysis report to
     identify expensive, long-running queries (high reads, CPU, and duration). <span
     style='mso-spacerun:yes'> </span>Tune these queries via indexing or query
     changes.<span style='mso-spacerun:yes'>  </span><o:p></o:p></span></li>
</ul>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'>The second
chart on this report shows wait time for the most common wait categories
graphed over time.<span style='mso-spacerun:yes'>  </span>If server performance
degraded at some point during the data capture, you can use this chart to
identify the wait category that increased near the beginning of the problem
period. <o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'>The third
and final section of this report shows distinct blocking chains.<span
style='mso-spacerun:yes'>  </span>The analysis script on which this report is
based makes an attempt to recognize when the same blocking chain persists for
an extended period so that each chain is only reported once. <span
style='mso-spacerun:yes'> </span>A high level summary of each blocking chain is
shown, including the duration of the blocking incident, the maximum number of
threads that were involved in the blocking incident, and the “Blocking Type”. <span
style='mso-spacerun:yes'> </span>This last value provides information about the
type of resource that was locked. <span style='mso-spacerun:yes'> </span>Possible
values include “LOCK BLOCKING” for blocking incidents involving lock resources;
“PAGELATCH_* WAITS” for non-I/O page latch contention (see the “Page Latch
(non-I/O)” bullet point, above, for more information); and “PAGEIOLATCH_* WAITS”,
which means that SQL is waiting for a data page to be read from or written to disk.
<span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'>Click on the
start time for a blocking chain to drill into a detailed view of that blocking
incident.<span style='mso-spacerun:yes'>  </span>The Blocking Chain Detail
report shows information like application name, login, active query text, transaction
start time, and hostname for the session that is at the head of the blocking
chain; and a list of all of the requests that are blocked by this session. <span
style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'>Other
comments: </span></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list .5in'><span
     lang=EN-ZW style='mso-ansi-language:EN-ZW'>A request that is waiting for
     some resource will accrue 1000 ms of wait time every second.<span
     style='mso-spacerun:yes'>  </span>So, for example, if you see that the wait
     time for some wait category averages 15000 ms wait time/sec, this means
     that 15 threads had that wait time at a typical moment during the
     reporting window. </span></li>
 <li class=MsoNormal style='mso-list:l1 level1 lfo1;tab-stops:list .5in'><span
     lang=EN-ZW style='mso-ansi-language:EN-ZW'>If you want to zoom in on a
     particular time window within a long-term data capture, click the
     parameters button on the report toolbar and choose a different Start Time
     and End Time. </span></li>
</ul>

<p class=MsoNormal><span lang=EN-ZW style='mso-ansi-language:EN-ZW'><o:p>&nbsp;</o:p></span></p>

</div>

</body>

</html>
